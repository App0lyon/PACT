# =========================================
#  PACT - ImageNet ResNet50 Configuration
#  Source: Appendix B (PACT Paper)
# =========================================

experiment_name: "PACT_ImageNet_ResNet50"
dataset:
  name: imagenet
  image_size: 224
  num_classes: 1000
  augmentations:
    - random_resized_crop
    - random_horizontal_flip
    - normalize

model:
  architecture: resnet50
  activation: pact
  pact:
    bit_width: 4
    init_alpha: 10.0
    lambda_alpha: 0.0001   # same as weight decay
    share_alpha: layer
    quantize_first_last: false

training:
  epochs: 110
  batch_size: 256
  optimizer: sgd
  momentum: 0.9
  weight_decay: 0.0001
  learning_rate:
    initial: 0.1
    schedule:
      milestones: [30, 60, 85, 95]
      gamma: 0.1
  criterion: cross_entropy
  regularization:
    type: l2
    alpha_reg: true

logging:
  save_dir: ./results/imagenet_resnet50/
  log_interval: 100
  save_best_only: true
  plot_alpha_evolution: true
  record_bitwidth_sweep: [2, 3, 4, 5]

hardware:
  device: cuda
  num_workers: 8
  fp16: true   # optional mixed precision
